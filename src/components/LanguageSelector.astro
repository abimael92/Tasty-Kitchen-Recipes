---
const { url } = Astro;
const pathLocale = url.pathname.split('/')[1];
const currentLocale = pathLocale === 'en' ? 'en' : 'es';
const locales = ['es', 'en'];
---

<select id='language-selector' class='simple-select' value={currentLocale}>
	{
		locales.map((locale) => (
			<option value={locale} selected={locale === currentLocale}>
				{locale === 'es' ? 'ES' : 'EN'}
			</option>
		))
	}
</select>

<script is:inline>
	// Your exact same code
	document.getElementById('language-selector').value =
		window.location.pathname.startsWith('/en') ? 'en' : 'es';

	document
		.getElementById('language-selector')
		.addEventListener('change', (e) => {
			const newLocale = e.target.value;
			const currentPath = window.location.pathname;

			if (currentPath === '/' || currentPath === '/en') {
				window.location.href = newLocale === 'es' ? '/' : '/en';
				return;
			}

			const pathWithoutLocale = currentPath.replace(/^\/(en|es)/, '');
			window.location.href =
				newLocale === 'es' ? pathWithoutLocale : `/en${pathWithoutLocale}`;
		});
</script>

<style>
	.simple-select {
		font-size: 14px;
		padding: 6px 10px;
		border-radius: 6px;
		border: 1px solid rgba(255, 255, 255, 0.4);
		background: rgba(0, 0, 0, 0.6);
		color: white;
		cursor: pointer;
		width: 70px;
		height: 36px;
		font-weight: 600;
	}

	.simple-select:hover {
		border-color: var(--color-accent);
		background: rgba(0, 0, 0, 0.7);
	}

	.simple-select:focus {
		outline: none;
		border-color: var(--color-accent);
	}

	.simple-select option {
		background: #333;
		color: white;
	}
</style>
